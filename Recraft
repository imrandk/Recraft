const delay=t=>new Promise(e=>setTimeout(e,t)),clickRecraftButton=()=>{let t=document.querySelector('button[data-testid="recraft-button"]');return t&&t.click(),Promise.resolve()},findRecraftButton=()=>{let t=document.querySelector('button[data-testid="recraft-button"]');return Promise.resolve(t&&"Recraft"===t.textContent.trim())},waitForRecraftButton=(t=1e3,e=30)=>new Promise(c=>{let a=0,r=setInterval(async()=>{if(a>=e){clearInterval(r),c(!1);return}await findRecraftButton()&&(clearInterval(r),c(!0)),a++},t)}),clickTogglerButton=()=>{let t=document.querySelector('[data-testid="recraft-topbar-export"] > [data-testid="toggler"]');return t&&t.click(),Promise.resolve()},clickSVGButton=()=>{let t=document.querySelectorAll("button.c-bZNrxE.c-cfmRqm.c-cfmRqm-fGHEql-stretch-true.c-cfmRqm-kumaHe-size-s.c-cfmRqm-ffVEBR-mode-primary.c-nSdQa");return t.forEach(t=>{"SVG"!==t.textContent.trim()||null===t.offsetParent||t.disabled||t.click()}),Promise.resolve()},clickSecondButton=()=>{let t=document.querySelector("button.c-xHEva:nth-child(2)");return t&&null!==t.offsetParent&&!t.disabled&&t.click(),Promise.resolve()},isCancelButtonPresent=()=>{let t=document.querySelector("button.c-bZNrxE.c-cfmRqm.c-cfmRqm-djDtlJ-stretch-false.c-cfmRqm-hdlaDN-size-m.c-cfmRqm-vSIUM-mode-secondary");return t&&"Cancel"===t.textContent.trim()},checkMaxConcurrencyMessage=()=>{let t=document.querySelector("div.c-kWXNTX.c-kWXNTX-ijbiex-visible-true");return t&&t.textContent.includes("Sorry, we canâ€™t recraft as fast as you click")},runSequentially=async()=>{for(let t=0;t<24;t++){if(isCancelButtonPresent()){console.log("Cancel button found. Stopping execution.");break}await delay(2e3),await clickRecraftButton();let e=!1;for(let c=0;c<5;c++){if(checkMaxConcurrencyMessage()){e=!0,console.log("Max Concurrency message found. Retrying the first button.");break}await delay(1e3)}!e&&(await delay(1e3),await waitForRecraftButton(),await delay(1e3),await clickTogglerButton(),await delay(1e3),await clickSVGButton(),await delay(1e3),await clickSecondButton(),await delay(1e3),await clickTogglerButton(),await delay(1e3),await clickSVGButton())}};runSequentially();
